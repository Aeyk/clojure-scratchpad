# =======================
# Shiro INI configuration
# =======================

[main]
# Objects and their properties are defined here,
# Such as the securityManager, Realms and anything
# else needed to build the SecurityManager
credentialsMatcher = org.apache.shiro.authc.credential.SimpleCredentialsMatcher
# credentialsMatcher = org.apache.shiro.authc.credential.DefaultPasswordService

securityManager.sessionManager.globalSessionTimeout = 1800000

# ds = com.impossibl.postgres.jdbc.PGDataSource
ds = org.postgresql.ds.PGPoolingDataSource
ds.serverName = localhost
ds.portNumber = 5432
ds.user = postgres
ds.password = t5csvbVsTNFGUCLtXvUy3q
ds.databaseName = scratch


jdbcRealm = org.apache.shiro.realm.jdbc.JdbcRealm
jdbcRealm.dataSource = $ds

# jdbcRealm.authenticationQuery = "SELECT * FROM auth_users WHERE username = ? AND password = ?"
# jdbcRealm.userRolesQuery = "SELECT role_name FROM auth_users_roles WHERE user_id = ?"
# jdbcRealm.permissionsQuery = "SELECT permissions FROM auth_users_permissions WHERE role_name = ?"


jdbcRealm.authenticationQuery = "SELECT password FROM auth_users WHERE user_name = ?"
jdbcRealm.userRolesQuery = "SELECT role_name FROM auth_user_roles WHERE user_name = ?"
jdbcRealm.permissionsQuery = "SELECT permission FROM auth_roles_permissions WHERE role_name = ?"

authc = org.apache.shiro.web.filter.authc.PassThruAuthenticationFilter
authc.loginUrl = /v1/api/users/login/
# authc.usernameParam = username
# authc.passwordParam = password
# authc.failureKeyAttribute = shiroLoginFailure


# hashService = org.apache.shiro.crypto.hash.DefaultHashService
# hashService.hashIterations = 1024
# hashService.hashAlgorithmName = BCRYPT
# hashService.generatePublicSalt = false

passwordService = org.apache.shiro.authc.credential.DefaultPasswordService
# passwordService.hashService = $hashService

# passwordMatcher = org.apache.shiro.authc.credential.PasswordMatcher
# passwordMatcher.passwordService = $passwordService

jdbcRealm.credentialsMatcher = $credentialsMatcher


jdbcRealm.permissionsLookupEnabled = false

shiro.loginUrl = /v1/api/user/login

cacheManager = org.apache.shiro.cache.MemoryConstrainedCacheManager
securityManager.cacheManager = $cacheManager

sessionManager = org.apache.shiro.web.session.mgt.DefaultWebSessionManager
securityManager.sessionManager = $sessionManager
securityManager.sessionManager.sessionIdCookieEnabled = false

# ssl.enabled = fales

securityManager.realms = $jdbcRealm


[users]
# The 'users' section is for simple deployments
# when you only need a small number of statically-defined
# set of User accounts.
admin=secretpassword



[roles]
# The 'roles' section is for simple deployments
# when you only need a small number of statically-defined
# roles.
admin=*

[urls]
# The 'urls' section is used for url-based security
# in web applications.  We'll discuss this section in the
# Web documentation
/v1/api/user/login = authc