{"version":3,"sources":["quil/sketch.cljs"],"mappings":"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","names":["quil.sketch/*applet*","quil.sketch/current-applet","js/p5.prototype","quil.sketch/rendering-modes","quil.sketch/resolve-renderer","mode","cljs.core._EQ_","quil.util/resolve-constant-key","quil.sketch/set-size","applet","width","height","temp__5743__auto__","el","inner-canvas","js/window","goog.style/getComputedStyle","var_args","G__43991","quil.sketch/size","js/Error","quil.sketch/bind-handlers","prc","opts","seq__43992","cljs.core/seq","chunk__43993","count__43994","i__43995","vec__44006","cljs.core.nth","cljs.core/chunked-seq?","c__4556__auto__","cljs.core/chunk-first","cljs.core/chunk-rest","cljs.core/count","vec__44011","cljs.core/first","cljs.core/next","processing-name","quil-name","handler","cljs.core/name","args","*applet*-orig-val__44009","*applet*-temp-val__44010","*applet*-orig-val__44014","*applet*-temp-val__44015","cljs.core.apply","quil.sketch/in-fullscreen?","or__4126__auto__","js/document","quil.sketch/add-fullscreen-support","old-size","cljs.core.atom","adjust-canvas-size","cljs.core/reset!","cljs.core/deref","goog.events/listen","goog.events.EventType/KEYDOWN","event","cljs.core/not","canvas","js/console","p1__44016#","quil.sketch/make-sketch","options","cljs.core/cons","quil.middlewares.deprecated-options/deprecated-options","cljs.core/comp","p1__44017#","cljs.core.merge","sketch-size","renderer","features","cljs.core/set","setup","cljs.core.concat","fexpr__44018","fexpr__44019","mouse-wheel","wheel-handler","evt","G__44020","goog.object/get","cljs.core.assoc","sketch","quil.util/initial-internal-state","quil.sketch/destroy-previous-sketch","host-elem","proc-obj","args__4742__auto__","len__4736__auto__","i__4737__auto__","argseq__4743__auto__","cljs.core/IndexedSeq","quil.sketch/sketch","seq44021","self__4724__auto__","opts-map","cljs.core/hash-map","js/p5","quil.sketch/sketch-init-list","quil.sketch/empty-body?","child","quil.sketch/add-canvas","canvas-id","quil.sketch/init-sketches","add-elem?","seq__44022","chunk__44023","count__44024","i__44025","sk","fexpr__44028","fexpr__44029","quil.sketch/add-sketch-to-init-list","cljs.core.swap_BANG_","cljs.core/conj","goog.events/listenOnce","goog.events.EventType/LOAD","cljs.core/List"],"sourcesContent":["(ns quil.sketch\n  (:require [quil.util :as u :include-macros true]\n            [quil.middlewares.deprecated-options :as do]\n            [goog.dom :as dom]\n            [goog.events :as events]\n            [goog.style :as style]\n            [goog.object :as object]\n            [goog.events.EventType :as EventType])\n  (:require-macros [quil.sketch]))\n\n(def ^:dynamic\n  *applet* nil)\n\n(defn current-applet [] *applet*)\n\n(u/generate-quil-constants :cljs\n                           rendering-modes (:java2d :p2d :p3d :opengl))\n\n(defn resolve-renderer [mode]\n  (if (= :p3d mode)\n    (aget js/p5.prototype \"WEBGL\")\n    (u/resolve-constant-key mode rendering-modes)))\n\n(defn set-size [applet width height]\n  (when-let [el (.-quil-canvas applet)]\n    ; p5js creates a <canvas> element inside provided <div> element\n    ; we need to resize only the canvas as outer div will adapt automatically\n    (let [inner-canvas (.querySelector el \"canvas\")]\n      (.resizeCanvas applet width height)\n      (.setAttribute inner-canvas \"width\" width)\n      (.setAttribute inner-canvas \"height\" height)\n      (aset (.-style inner-canvas) \"width\" (str width \"px\"))\n      (aset (.-style inner-canvas) \"height\" (str height \"px\"))\n      (set! (.-width applet)\n            (.parseInt js/window (style/getComputedStyle inner-canvas \"width\")))\n      (set! (.-height applet)\n            (.parseInt js/window (style/getComputedStyle inner-canvas \"height\"))))))\n\n(defn size\n  ([width height]\n   (.createCanvas (current-applet) (int width) (int height)))\n\n  ([width height mode]\n   (.createCanvas (current-applet) (int width) (int height) (resolve-renderer mode))))\n\n(defn- bind-handlers [prc opts]\n  (doseq [[processing-name quil-name] {:setup :setup\n                                       :draw :draw\n\n                                       :keyPressed :key-pressed\n                                       :keyReleased :key-released\n                                       :keyTyped :key-typed\n\n                                       :mouseClicked :mouse-clicked\n                                       :mouseDragged :mouse-dragged\n                                       :mouseMoved :mouse-moved\n                                       :mousePressed :mouse-pressed\n                                       :mouseReleased :mouse-released\n                                       :mouseOut :mouse-exited\n                                       :mouseOver :mouse-entered\n                                       :mouseWheel :mouse-wheel}]\n    (when-let [handler (opts quil-name)]\n      (aset prc (name processing-name)\n            (fn [& args]\n              (quil.sketch/with-sketch prc\n                (apply handler args)))))))\n\n(defn in-fullscreen? []\n  (or (.-fullscreenElement js/document)\n      (.-mozFullScreenElement js/document)))\n\n(defn add-fullscreen-support\n  \"Adds fullscreen support for the provided `p5` object.\n  Fullscreen is enabled when the user presses `F11`. We turn\n  the sketch `<canvas>` element to fullscreen storing the old size\n  in an `atom`. When the user cancels fullscreen (`F11` or `Esc`)\n  we resize the sketch back to the old size.\"\n  [applet]\n  (let [old-size (atom nil)\n        adjust-canvas-size\n        (fn []\n          (if (in-fullscreen?)\n            (do\n              (reset! old-size\n                      [(.-width applet) (.-height applet)])\n              (set-size applet\n                        (-> js/window .-screen .-width)\n                        (-> js/window .-screen .-height)))\n            (apply set-size applet @old-size)))]\n    (events/listen js/window EventType/KEYDOWN\n                   (fn [event]\n                     (when (and (= (.-key event) \"F11\")\n                                (not (in-fullscreen?)))\n                       (.preventDefault event)\n                       (let [canvas (.-quil-canvas applet)]\n                         (cond (.-requestFullscreen canvas) (.requestFullscreen canvas)\n                               (.-mozRequestFullScreen canvas) (.mozRequestFullScreen canvas)\n                               :else (.warn js/console \"Fullscreen mode is not supported in current browser.\"))))))\n    (events/listen js/document \"fullscreenchange\" adjust-canvas-size)\n    (events/listen js/document \"mozfullscreenchange\" adjust-canvas-size)\n    (events/listen js/document \"fullscreenerror\"\n                   #(.error js/console \"Error while switching to/from fullscreen: \" %))))\n\n(defn make-sketch [options]\n  (let [opts            (->> (:middleware options [])\n                             (cons do/deprecated-options)\n                             (apply comp)\n                             (#(% options))\n                             (merge {:size [500 300]}))\n\n        sketch-size     (:size opts)\n        renderer        (:renderer opts)\n        features        (set (:features opts))\n\n        setup (fn []\n                (->> (if renderer [renderer] [])\n                     (concat sketch-size)\n                     (apply size))\n                (when (:settings opts) ((:settings opts)))\n                (when (:setup opts) ((:setup opts))))\n        mouse-wheel (when-let [wheel-handler (:mouse-wheel opts)]\n                      ; using (get \"delta\") because in advanced mode\n                      ; it will be renamed otherwise.\n                      (fn [evt] (wheel-handler (object/get evt \"delta\"))))\n\n        opts (assoc opts\n                    :setup setup\n                    :mouse-wheel mouse-wheel)\n\n        sketch (fn [prc]\n                 (bind-handlers prc opts)\n                 (set! (.-quil prc) (atom nil))\n                 (set! (.-quil-internal-state prc) (atom u/initial-internal-state)))]\n    sketch))\n\n(defn destroy-previous-sketch [host-elem]\n  (when-let [proc-obj (.-processing-obj host-elem)]\n    (.remove proc-obj)))\n\n(defn sketch [& opts]\n  (let [opts-map (apply hash-map opts)\n        host-elem (:host opts-map)\n        renderer (or (:renderer opts-map) :p2d)\n        host-elem (if (string? host-elem)\n                    (.getElementById js/document host-elem)\n                    host-elem)]\n    (if host-elem\n      (do\n        (if (.-processing-context host-elem)\n          (when-not (= renderer (.-processing-context host-elem))\n            (.warn js/console \"WARNING: Using different context on one canvas!\"))\n          (set! (.-processing-context host-elem) renderer))\n        (destroy-previous-sketch host-elem)\n        (let [proc-obj (js/p5. (make-sketch opts-map) host-elem)]\n          (set! (.-processing-obj host-elem) proc-obj)\n          (set! (.-quil-canvas proc-obj) host-elem)\n          (add-fullscreen-support proc-obj)\n          proc-obj))\n      (.error js/console\n              (if (:host opts-map)\n                (str \"ERROR: Cannot find host element: \" (:host opts-map))\n                \"ERROR: Cannot create sketch. :host is not specified or element not found.\")))))\n\n(def sketch-init-list (atom (list)))\n\n(defn empty-body? []\n  (let [child (.-childNodes (.-body js/document))]\n    ; seems hacky, we should come up with better way of\n    ; checking whether body is empty or not\n    (<= (.-length child) 1)))\n\n(defn add-canvas [canvas-id]\n  (let [canvas (.createElement js/document \"canvas\")]\n    (.setAttribute canvas \"id\" canvas-id)\n    (.appendChild (.-body js/document) canvas)))\n\n(defn init-sketches []\n  (let [add-elem? (empty-body?)]\n    (doseq [sk @sketch-init-list]\n      (when add-elem?\n        (add-canvas (:host-id sk)))\n      ((:fn sk))))\n  (reset! sketch-init-list []))\n\n(defn add-sketch-to-init-list [sk]\n  (swap! sketch-init-list conj sk)\n  ; if page already loaded immediately init sketch we just added\n  (when (= (.-readyState js/document) \"complete\")\n    (init-sketches)))\n\n(events/listenOnce js/window EventType/LOAD init-sketches)\n"]}